var selectizeValue,selectHW,price={},difficulty={},userInput={},results={},moneroInfo={},$jq=jQuery.noConflict(),cardInfo={},inputsCards=[],currentQuantityID="#q1",currentCardID="#c1";function calculateCoinsMinedBTC(e){if("TH/s"==e.hashrateUnit)var t=e.hashrate*Math.pow(10,12);else if("GH/s"==e.hashrateUnit)t=e.hashrate*Math.pow(10,9);else t=e.hashrate*Math.pow(10,6);return t*(1-e.fee/100)*(1-e.reject/100)*e.reward/(Math.pow(2,32)*e.diff)}function calculateCoinsMinedETH(e){if("TH/s"==e.hashrateUnit)var t=1,a=e.hashrate*Math.pow(10,6);else if("GH/s"==e.hashrateUnit)t=1e3,a=e.hashrate*Math.pow(10,3);else t=1e6,a=e.hashrate;return a*t/(e.diff/Math.pow(10,12)/14.8*Math.pow(10,12))*(60/14.8*e.reward)*(1-e.fee/100)*(1-e.reject/100)/60}function calculateCoinsMinedLTC(e){if("TH/s"==e.hashrateUnit)var t=e.hashrate*Math.pow(10,9);else if("GH/s"==e.hashrateUnit)t=e.hashrate*Math.pow(10,6);else t=e.hashrate*Math.pow(10,3);return e.reward*t/(49.7*e.diff)/86400}function calculateCoinsMinedZEC(e){if("Sols/s"==e.hashrateUnit)var t=e.hashrate;else if("kSols/s"==e.hashrateUnit)t=1e3*e.hashrate;return t*(1-e.fee/100)*(1-e.reject/100)/(8192*e.diff)*e.reward}function calculateCoinsMinedXMR(e){if("H/s"==e.hashrateUnit)var t=e.hashrate;else if("kH/s"==e.hashrateUnit)t=1e3*e.hashrate;else if("MH/s"==e.hashrateUnit)t=1e6*e.hashrate;return t*(1-e.fee/100)*(1-e.reject/100)*moneroInfo.blockReward/moneroInfo.difficulty}function calculateProfitPerTimeFrame(e,t,a){var n={};n.miningProfitH=3600*e,n.miningProfitD=86400*e,n.miningProfitW=604800*e,n.miningProfitM=2628e3*e,n.year=0,n.miningProfitY=[];for(var r=Math.abs(1-t/100),i=0;i<=a;i++)0==i?n.miningProfitY[i]=0:1==i?(n.miningProfitY[i]=n.miningProfitM,n.year+=n.miningProfitY[i]):(r>1&&(r*=-1),n.miningProfitY[i]=Math.abs(n.miningProfitY[i-1])*r,i<13&&(n.year+=n.miningProfitY[i]));return n}function calculateCosts(e){var t={};return t.H=e,t.D=24*e,t.W=168*e,t.M=730*e,t.Y=8760*e,t}function calculateNetProfit(e,t,a,n,r){var i={};i.h=t.miningProfitH*n-e.H,i.d=t.miningProfitD*n-e.D,i.w=t.miningProfitW*n-e.W,i.m=t.miningProfitM*n-e.M,i.y=[],i.year=0;for(var s=1+r/100,l=0;l<=a;l++)0==l?i.y[l]=0:(n*=s,i.y[l]=t.miningProfitY[l]*n-e.M,l<13&&(i.year+=i.y[l]));return i}function calculateROI(e,t,a){for(var n=[],r=0;r<=a;r++)n[r]=0==r?-1*t:n[r-1]+e.y[r];return n}function calculateBE(e,t){for(var a=0;e>0;)e-=t.y[a],a++;return a>2?30.417*(a-2)+(30.417- -1*e/t.y[a]*30.417):30.417- -1*e/t.y[a-1]*30.417}function drawChart(e,t,a){for(var n=[],r=0;r<=e;r++)n[r]=r;var i=document.getElementById("chart").getContext("2d");new Chart(i,{type:"line",data:{datasets:[{label:"Mining revenue/month",data:t,borderColor:"rgba(45, 118, 237, 1)",backgroundColor:"rgba(45, 118, 237, 0.5)"},{label:"Profit $$$",data:a,borderColor:"rgb(255, 239, 22)",backgroundColor:"rgba(255, 239, 22, 0.5)"}],labels:n},options:{scales:{yAxes:[{scaleLabel:{display:!0,labelString:""},ticks:{suggestedMin:a[0],suggestedMax:t[t.length-1]}}],xAxes:[{scaleLabel:{display:!0,labelString:"months"}}]},responsive:!0,events:["click"]}})}function fillFormWithCardInfo(e){for(var t=0,a=parseInt(currentQuantityID.slice(2)),n=0,r=0,i=0,s="#c1",l="#q1",o=1;o<=a;o++){s="#c"+o.toString(),l="#q"+o.toString(),t=$jq(l).val(),console.log(s);for(var u in cardInfo)for(var c=0;c<cardInfo[u].length;c++)if(cardInfo[u][c].Name==$jq(s).val()){var d=cardInfo[u][c];console.log(d),"w"==d.PowerConsumption.substring(d.PowerConsumption.length-1,d.PowerConsumption.length)?n+=d.PowerConsumption.substring(0,d.PowerConsumption.length-1)*t:n+=d.PowerConsumption*t,i+=d.Cost*t,"TH/s"==$jq("#hashRateUnit").val()?r+=d.HashesPerSecond/Math.pow(10,12)*t:"GH/s"==$jq("#hashRateUnit").val()?r+=d.HashesPerSecond/Math.pow(10,9)*t:"MH/s"==$jq("#hashRateUnit").val()?r+=d.HashesPerSecond/Math.pow(10,6)*t:"kH/s"==$jq("#hashRateUnit").val()||"kSols/s"==$jq("#hashRateUnit").val()?r+=d.HashesPerSecond/Math.pow(10,3)*t:"H/s"!=$jq("#hashRateUnit").val()&&"Sols/s"!=$jq("#hashRateUnit").val()||(r+=d.HashesPerSecond*t)}}$jq("#hashrate").val(r),$jq("input[name=invest]").val(i),$jq("input[name=power]").val(n),sendParameters()}function addHW(e){for(var t="",a=0;a<cardInfo.rigs.length;a++)t+="<option value='"+cardInfo.rigs[a].Name+"'>"+cardInfo.rigs[a].Name+"</option>";$jq(".rigs").append(t),t="";for(a=0;a<cardInfo.ASIC.length;a++)t+="<option value='"+cardInfo.ASIC[a].Name+"'>"+cardInfo.ASIC[a].Name+"</option>";$jq(".asics").append(t),t="";for(a=0;a<cardInfo.cards.length;a++)t+="<option value='"+cardInfo.cards[a].Name+"'>"+cardInfo.cards[a].Name+"</option>";$jq(".gpus").append(t),console.log(e),selectHW=$jq(e).selectize({sortField:"text",lockOptgroupOrder:"True",onChange:function(e){selectizeValue=e,fillFormWithCardInfo(e)}}),inputsCards.push(selectHW),$jq(".numCardsHW").keyup(sendParameters)}function constructHtmlCardCode(e,t){return e=e.slice(1),t=t.slice(1),htmlCodeCard='<div class="form-group form-inline  float-right celRow">\n                                    <input id="'+t+'" name=\'numCards\' type=\'number\' value="1" step="1"\n                                           class="form-control form-control-sm  numCardsHW"/>\n                                    <i class="fas fa-times"></i>\n                                    <select id="'+e+'" class="form-control form-control-sm cardsHW"\n                                            >\n                                        <option value="">Mining equipment...</option>\n                                        <optgroup label="GPUs" class="gpus">\n                                        </optgroup>\n                                        <optgroup label="ASICs" class="asics">\n                                        </optgroup>\n                                        <optgroup label="Rigs" class="rigs">\n                                        </optgroup>\n                                    </select>\n                                </div>'}function addListeners(){$jq("#hashRateUnit").change(sendParameters),$jq("input[name=hashrate]").keyup(sendParameters),$jq("input[name=fee]").keyup(sendParameters),$jq("input[name=reject]").keyup(sendParameters),$jq("input[name=reward]").keyup(sendParameters),$jq("input[name=diff]").keyup(sendParameters),$jq("input[name=CoinValueChange]").keyup(sendParameters),$jq("input[name=value]").keyup(sendParameters),$jq("input[name=power]").keyup(sendParameters),$jq("input[name=powerCost]").keyup(sendParameters),$jq("input[name=diffChange]").keyup(sendParameters),$jq("input[name=invest]").keyup(sendParameters),$jq("input[name=time]").keyup(sendParameters)}function sendParameters(){userInput.currency=$jq("#currency").val(),userInput.hashrate=$jq("input[name=hashrate]").val(),userInput.fee=$jq("input[name=fee]").val(),userInput.reject=$jq("input[name=reject]").val(),userInput.reward=$jq("input[name=reward]").val(),userInput.diff=$jq("input[name=diff]").val(),userInput.value=$jq("input[name=value]").val(),userInput.hashrateUnit=$jq("select[name=hashrateUnit]").val(),userInput.power=$jq("input[name=power]").val(),userInput.powerCost=$jq("input[name=powerCost]").val(),userInput.diffChange=$jq("input[name=diffChange]").val(),userInput.invest=$jq("input[name=invest]").val(),userInput.timeFrame=$jq("input[name=time]").val(),userInput.coinValueChange=$jq("input[name=CoinValueChange]").val();var e=userInput.power*userInput.powerCost/1e3;"BTC"==userInput.currency?results.miningProfitS=calculateCoinsMinedBTC(userInput):"ETH"==userInput.currency?results.miningProfitS=calculateCoinsMinedETH(userInput):"ZEC"==userInput.currency?results.miningProfitS=calculateCoinsMinedZEC(userInput):"XMR"==userInput.currency?results.miningProfitS=calculateCoinsMinedXMR(userInput):results.miningProfitS=calculateCoinsMinedLTC(userInput);var t=calculateProfitPerTimeFrame(results.miningProfitS,userInput.diffChange,userInput.timeFrame),a=calculateCosts(e),n=calculateNetProfit(a,t,userInput.timeFrame,userInput.value,userInput.coinValueChange),r=calculateROI(n,userInput.invest,userInput.timeFrame);if("0"!=userInput.invest){var i=calculateBE(userInput.invest,n);isNaN(i)?$jq("#BE").text("Never"):$jq("#BE").text(i.toFixed(2))}drawChart(userInput.timeFrame,n.y,r),$jq(".h :nth-child(2)").html(t.miningProfitH.toFixed(7)),$jq(".h :nth-child(3)").html((n.h+a.H).toFixed(2)),$jq(".h :nth-child(4)").html(a.H.toFixed(2)),$jq(".h :nth-child(5)").html(n.h.toFixed(2)),$jq(".d :nth-child(2)").html(t.miningProfitD.toFixed(4)),$jq(".d :nth-child(3)").html((n.d+a.D).toFixed(2)),$jq(".d :nth-child(4)").html(a.D.toFixed(2)),$jq(".d :nth-child(5)").html(n.d.toFixed(2)),$jq(".w :nth-child(2)").html(t.miningProfitW.toFixed(4)),$jq(".w :nth-child(3)").html((n.w+a.W).toFixed(2)),$jq(".w :nth-child(4)").html(a.W.toFixed(2)),$jq(".w :nth-child(5)").html(n.w.toFixed(2)),$jq(".m :nth-child(2)").html(t.miningProfitM.toFixed(4)),$jq(".m :nth-child(3)").html((n.m+a.M).toFixed(2)),$jq(".m :nth-child(4)").html(a.M.toFixed(2)),$jq(".m :nth-child(5)").html(n.m.toFixed(2)),$jq(".y :nth-child(2)").html(t.year.toFixed(4)),$jq(".y :nth-child(3)").html((n.year+a.Y).toFixed(2)),$jq(".y :nth-child(4)").html(a.Y.toFixed(2)),$jq(".y :nth-child(5)").html(n.year.toFixed(2))}$jq(window).on("load",function(){addListeners(),userInput.selectedCurrency=$jq("select[name=currency]").val(),$jq.post("/diffBTC").done(function(e){difficulty.btc=e.difficultyBTC,$jq("#diff").val(difficulty.btc)}),$jq.post("/diffETH").done(function(e){difficulty.eth=e.difficultyETH[0].difficulty}),$jq.post("/diffLTC").done(function(e){difficulty.ltc=e.difficultyLTC}),$jq.post("/diffZEC").done(function(e){difficulty.zec=Math.round(e.difficultyZEC)}),$jq.post("/moneroInfo").done(function(e){moneroInfo=e}),$jq.post("/price").done(function(e){price.btc=e.valueBTC,price.eth=e.valueETH,price.ltc=e.valueLTC,price.zec=e.valueZEC,price.xmr=e.valueXMR,"BTC"==userInput.selectedCurrency&&$jq("#value").val(price.btc)}),$jq.post("/cards").done(function(e){cardInfo.cards=e.cards,cardInfo.ASIC=e.ASIC,cardInfo.rigs=e.rigs,addHW(currentCardID)}),drawChart(12,0,0),$jq(".drawer").drawer(),$jq("#my_popup").popup({opacity:.8,transition:"all 0.5s",onopen:function(){$jq("main,h1,h3").css({filter:"blur(5px)","-webkit-filter":"blur(5px)"})},onclose:function(){$jq("main,h1,h3").css({filter:"blur(0px)","-webkit-filter":"blur(0px)"})}}),$jq(window).width()<480&&0==window.scrollY&&$jq("#crtice").hide(),$jq(window).width()<480&&$jq("#crtice").hide(),tippy("[title]",{placement:"left",animation:"scale",duration:500,arrow:!0}),$jq("#my_popup").css({"margin-top":"0"}),$jq("#btcLogo").css({display:"block"}),$jq("#advancedAwrapper").click(function(){$jq("#advancedOptions").slideToggle(),$jq("#advancedArrow").hasClass("fa-angle-up")?($jq("#advancedArrow").removeClass("fa-angle-up"),$jq("#advancedArrow").addClass("fa-angle-down")):$jq("#advancedArrow").hasClass("fa-angle-down")&&($jq("#advancedArrow").removeClass("fa-angle-down"),$jq("#advancedArrow").addClass("fa-angle-up"))})}),$jq(document).scroll(function(){$jq(this).scrollTop()>50&&$jq(window).width()<480?$jq("#crtice").fadeIn():$jq(window).width()<480&&$jq("#crtice").fadeOut()}),setTimeout(function(){$jq("#welcomeMessage").css({"border-style":"hidden"})},4400),$jq(function(){$jq('[data-toggle="tooltip"]').tooltip()}),$jq("#addCards").on("click",function(){currentCardID="#c"+(parseInt(currentCardID.slice(2))+1).toString(),currentQuantityID="#q"+(parseInt(currentQuantityID.slice(2))+1).toString();var e=constructHtmlCardCode(currentCardID,currentQuantityID);$jq("#cards").append(e),addHW(currentCardID)}),$jq("select[name=currency]").change(function(){userInput.selectedCurrency=$jq("select[name=currency]").val(),$jq("input[name=hashrate]").val(""),$jq("#BE").text("0"),$jq(".sols").css({display:"none"}),$jq(".hashes").css({display:"block"}),$jq(".slowHashrate").css({display:"none"}),$jq("#btcLogo").css({display:"none"}),$jq("#ltcLogo").css({display:"none"}),$jq("#ethLogo").css({display:"none"}),$jq("#zecLogo").css({display:"none"}),$jq("#xmrLogo").css({display:"none"}),"BTC"==userInput.selectedCurrency?($jq("#valuta").text("BTC"),$jq("#value").val(price.btc),$jq("input[name=reward]").val("12.5"),$jq("#diff").val(difficulty.btc),$jq("#hashRateUnit").val("TH/s"),$jq("#btcLogo").css({display:"block"})):"ETH"==userInput.selectedCurrency?($jq("#valuta").text("ETH"),$jq("input[name=reward]").val("3"),$jq("#value").val(price.eth),$jq("#diff").val(difficulty.eth),$jq("#hashRateUnit").val("MH/s"),$jq("#ethLogo").css({display:"block"})):"ZEC"==userInput.selectedCurrency?($jq("#valuta").text("ZEC"),$jq("input[name=reward]").val("10"),$jq("#value").val(price.zec),$jq("#diff").val(difficulty.zec),$jq(".hashes").css({display:"none"}),$jq(".sols").css({display:"block"}),$jq("#hashRateUnit").val("Sols/s"),$jq("#zecLogo").css({display:"block"})):"XMR"==userInput.selectedCurrency?($jq("#valuta").text("XMR"),$jq("input[name=reward]").val(moneroInfo.blockReward.toFixed(4)),$jq("#value").val(price.xmr),$jq("#diff").val(moneroInfo.difficulty),$jq(".hashes").css({display:"none"}),$jq(".slowHashrate").css({display:"block"}),$jq("#hashRateUnit").val("kH/s"),$jq("#xmrLogo").css({display:"block"})):($jq("#valuta").text("LTC"),$jq("#value").val(price.ltc),$jq("input[name=reward]").val("25"),$jq("#diff").val(difficulty.ltc),$jq("#hashRateUnit").val("MH/s"),$jq("#ltcLogo").css({display:"block"})),fillFormWithCardInfo(selectizeValue)}),$jq(".numCardsHW").keyup(function(){fillFormWithCardInfo(selectizeValue)}),$jq("#resetButton").click(function(){userInput.selectedCurrency=$jq("select[name=currency]").val(),$jq("input[name=CoinValueChange]").val("0"),$jq("input[name=diffChange]").val("0"),$jq("input[name=fee]").val("1"),$jq("input[name=powerCost]").val("0.1"),$jq("input[name=reject]").val("1"),$jq("input[name=power]").val("0"),$jq("input[name=invest]").val("0"),$jq("input[name=time]").val("12"),$jq("#equipment-selectized").val("");var e=constructHtmlCardCode(currentCardID="#c1",currentQuantityID="#q1");$jq("#cards").html(e),addHW(currentCardID),$jq(".numCardsHW").val("1"),"BTC"==userInput.selectedCurrency?($jq("#hashrate").val(""),$jq("#valuta").text("BTC"),$jq("#value").val(price.btc),$jq("input[name=reward]").val("12.5"),$jq("#diff").val(difficulty.btc),$jq("#hashRateUnit").val("TH/s"),sendParameters()):"ETH"==userInput.selectedCurrency?($jq("#hashrate").val(""),$jq("#valuta").text("ETH"),$jq("input[name=reward]").val("3.5"),$jq("#value").val(price.eth),$jq("#diff").val(difficulty.eth),$jq("#hashRateUnit").val("MH/s"),sendParameters()):"ZEC"==userInput.selectedCurrency?($jq("#hashrate").val(""),$jq("#valuta").text("ZEC"),$jq("input[name=reward]").val("10"),$jq("#value").val(price.zec),$jq("#diff").val(difficulty.zec),$jq("#hashRateUnit").val("Sols/s"),sendParameters()):"XMR"==userInput.selectedCurrency?($jq("#hashrate").val(""),$jq("#valuta").text("XMR"),$jq("input[name=reward]").val(moneroInfo.blockReward),$jq("#value").val(price.xmr),$jq("#diff").val(moneroInfo.difficulty),$jq("#hashRateUnit").val("kH/s"),sendParameters()):($jq("#hashrate").val(""),$jq("#valuta").text("LTC"),$jq("#value").val(price.ltc),$jq("input[name=reward]").val("25"),$jq("#diff").val(difficulty.ltc),$jq("#hashRateUnit").val("MH/s"),sendParameters())});